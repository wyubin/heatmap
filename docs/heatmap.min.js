var heatmap=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){t.i="HTMLElement.js",HTMLElement.prototype.append_by_array=function(t){var e=this;return t.map(function(t){var n;1==t.nodeType?n=t:t.name?(n=document.createElement(t.name),t.attr&&Object.keys(t.attr).map(function(e){n.setAttribute(e,t.attr[e])}),t.child&&t.child.hasOwnProperty("length")?n.append_by_array(t.child):t.html&&(n.innerHTML=t.html)):n=document.createTextNode(t),e.appendChild(n)}),this},HTMLElement.prototype.detach=function(){return this.parentNode&&this.parentNode.removeChild(this),this},HTMLElement.prototype.scroll_to=function(){window.scrollTo(this.offsetLeft+this.clientLeft,this.offsetTop+this.clientTop)}},function(t,e,n){t.i="mytooltip",n(0);var r=n(2)._extend,o=function(t,e){if(!t){var n=document.createElement("div");document.body.appendChild(n)}this.doms={body:t||n},this.args=r({sto_delay:300},e),this.var={},this.init()};t.exports=o,o.prototype.init=function(){var t=this;"mytooltip hide".split(/\s+/).map(function(e){t.doms.body.classList.add(e)}),this.doms.body.append_by_array([{name:"div",attr:{class:"content"}}]),this.doms.content=this.doms.body.querySelector("div.content"),this.doms.content.addEventListener("mouseover",function(e){clearTimeout(t.var.sto_out)}),this.doms.content.addEventListener("mouseout",function(e){t.hide()})},o.prototype.render=function(t){return this.doms.content.innerHTML="",this.doms.content.append_by_array(t),this},o.prototype.show_pos=function(t,e){var n=this,o=r(this.args.style||{},t);return n.doms.body.classList.remove("hide"),Object.keys(o).map(function(t){n.doms.body.style[t]=o[t]}),e&&this.render(e),this},o.prototype.hide=function(){var t=this;return clearTimeout(t.var.sto_over),this.var.sto_out=setTimeout(function(){t.doms.body.classList.add("hide")},this.args.sto_delay),this},o.prototype.show_dom=function(t,e){var n,r,o;if(t instanceof Event)r={top:t.pageY,left:t.pageX};else if(1==t.nodeType){n=t.getBoundingClientRect();var i=document.body.getBoundingClientRect();r={top:parseFloat(n.top+n.bottom)/2-(i.top>0?0:i.top),left:parseFloat(n.left+n.right)/2-(i.left>0?0:i.left)}}else"object"==typeof t&&(r=t);return Object.keys(r).map(function(t){isNaN(r[t])||(r[t]=r[t]+"px")}),o="function"==typeof e?e():e,this.show_pos(r,o),this},o.prototype.show=function(t,e){var n=this;this.var.sto_over=setTimeout(function(){n.show_dom(t,e)},this.args.sto_delay)}},function(t,e,n){(function(t,r){var o=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(t).replace(o,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),c=r[n];n<i;c=r[++n])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},e.deprecate=function(n,o){if(g(t.process))return function(){return e.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}};var i,a={};function s(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,t,r.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function l(t,e){return t}function u(t,n,r){if(t.customInspect&&n&&A(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return v(o)||(o=u(t,o,r)),o}var i=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(y(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(i)return i;var a=Object.keys(n),s=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),x(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return p(n);if(0===a.length){if(A(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(_(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(b(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return p(n)}var l,w="",E=!1,M=["{","}"];(f(n)&&(E=!0,M=["[","]"]),A(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return _(n)&&(w=" "+RegExp.prototype.toString.call(n)),b(n)&&(w=" "+Date.prototype.toUTCString.call(n)),x(n)&&(w=" "+p(n)),0!==a.length||E&&0!=n.length?r<0?_(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=E?function(t,e,n,r,o){for(var i=[],a=0,s=e.length;a<s;++a)T(e,String(a))?i.push(h(t,e,n,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(h(t,e,n,r,o,!0))}),i}(t,n,r,s,a):a.map(function(e){return h(t,n,r,s,e,E)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(l,w,M)):M[0]+w+M[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),T(r,o)||(a="["+o+"]"),s||(t.seen.indexOf(c.value)<0?(s=m(n)?u(t,c.value,null):u(t,c.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return"number"==typeof t}function v(t){return"string"==typeof t}function g(t){return void 0===t}function _(t){return w(t)&&"[object RegExp]"===E(t)}function w(t){return"object"==typeof t&&null!==t}function b(t){return w(t)&&"[object Date]"===E(t)}function x(t){return w(t)&&("[object Error]"===E(t)||t instanceof Error)}function A(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(g(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=d,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=_,e.isObject=w,e.isDate=b,e.isError=x,e.isFunction=A,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(12);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),S[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(13),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(10),n(11))},function(t,e,n){n(4),n(5),n(6),n(7),n(0),n(8),n(9);var r=n(2)._extend,o=n(17),i=n(18).saveAs;function a(t,e){this.doms={body:t},this.mod={},this.args=r({color:["#59F2F7","#F75D59"],revise:{names:["z-score(column)","z-score(row)"],methods:[function(t){return{data:t.data.transpose().map(function(t){return t.z_scores()}).transpose(),colnames:t.colnames,rownames:t.rownames}},function(t){return{data:t.data.map(function(t){return t.z_scores()}),colnames:t.colnames,rownames:t.rownames}}],value:[]},width:400,height:400},e),this.env={sel_row:[]},this.init()}mytooltip=n(1),events_reg=n(21),n(23),n(28),t.exports=a,a.prototype.init=function(){this.doms_prep(),this.dom_event()},a.prototype.doms_prep=function(){var t=this;this.doms.body.classList.add("heatmap");var e=["colDend","rowDend","colormap"].map(function(e){var n=SVGAElement.prototype.create_node("svg").set_attr("class",e);return t.doms[e]=n,n});this.doms.body.append_by_array([{name:"div",attr:{class:"inner"},child:[{name:"div",attr:{class:"info"},child:[{name:"div",attr:{class:"colorbar"}},{name:"form",attr:{class:"f_control"},child:[{name:"input",attr:{type:"color",name:"c_low",title:"change color"}},{name:"input",attr:{type:"color",name:"c_high",title:"change color"}},{name:"input",attr:{name:"b_save",type:"button",value:"save data table"}},{name:"div",attr:{class:"div_revise"}}]}]}].concat(e)}]),Array.prototype.slice.apply(this.doms.body.querySelectorAll("[class]")).map(function(e){t.doms[e.className]=e}),this.mod.t_tip=new mytooltip},a.prototype.dom_event=function(){var t=this;this.zbehav={},["col_d","row_d","cmap_x","cmap_y"].map(function(e){t.zbehav[e]=d3.behavior.zoom().scaleExtent([1,1/0])}),d3.select(this.doms.colDend).call(this.zbehav.col_d),d3.select(this.doms.rowDend).call(this.zbehav.row_d),t.cmap_zoom(),this.doms.f_control.b_save.onclick=function(e){t.data_save(e)},this.doms.f_control.onchange=function(e){t.re_plot()},this.cmap_e=new events_reg(this.doms.colormap),this.cmap_e.events.mouseover={"rect.datapt":function(e){var n=t.env.mat_clus.row_ind[e.target.rowIndex],r=t.env.mat_clus.col_ind[e.target.colIndex];t.mod.t_tip.show(e.target,[{name:"div",html:t.tip_html(n,r,t.env.t_data)}]),t.doms.body.classList.add("highlighting"),t.env.col_dend.leaves[e.target.colIndex].classList.add("active"),t.env.row_dend.leaves[e.target.rowIndex].classList.add("active")}},this.cmap_e.events.mouseout={"rect.datapt":function(e){t.mod.t_tip.hide(),t.doms.body.classList.remove("highlighting"),t.env.col_dend.leaves[e.target.colIndex].classList.remove("active"),t.env.row_dend.leaves[e.target.rowIndex].classList.remove("active")}},this.cmap_e.events.click={"rect.datapt":function(e){t.env.row_dend.leaves[e.target.rowIndex].classList.toggle("select"),t.sel_data_ck()}},this.cmap_e.register()},a.prototype.plot=function(t){return 0==this.doms.div_revise.children.length&&this.default_set(),this.re_plot(t)},a.prototype.default_set=function(){var t=this;["c_low","c_high"].map(function(e,n){t.doms.f_control[e].value=t.args.color[n]});var e=[];this.args.revise.names.map(function(t,n){e=e.concat([{name:"span",child:[{name:"input",attr:{type:"checkbox",name:"revise_ck",value:n}},t]},{name:"br"}])}),this.doms.div_revise.append_by_array(e),this.doms.f_control.val({revise_ck:this.args.revise.value})},a.prototype.re_plot=function(t){var e=this;t&&(this.env.data=t),this.env.args=this.doms.f_control.val(),this.env.t_data=this.data_revise(),this.layout_ck(),this.colorbar(),this.env.mat_clus=this.matrix_cluster(),["col","row"].map(function(t){e.env[t+"_dend"]=e.dendrogram(t)}),e.env.cmap=e.colormap(),this.env.sel_row.length&&this.sel_locale()},a.prototype.layout_ck=function(){var t=this.env.t_data.rownames.reduce(function(t,e){return e.length>t?e.length:t},0),e=this.env.t_data.colnames.reduce(function(t,e){return e.length>t?e.length:t},0),n=this,r=this.doms.body.getBoundingClientRect(),o=110+7*t,i=110+7*e,a=r.width-o,s=r.height-i,c=[[0,0,o,i],[0,o,a,i],[i,0,o,s],[i,o,a,s]];["info","colDend","rowDend","colormap"].map(function(t,e){n.doms[t].style.top=c[e][0]+"px",n.doms[t].style.left=c[e][1]+"px",n.doms[t].style.width=c[e][2]+"px",n.doms[t].style.height=c[e][3]+"px"})},a.prototype.data_revise=function(){var t=this,e=this.env.data;return this.env.args.revise_ck.map(function(n){e=t.args.revise.methods[n](e)}),e},a.prototype.colorbar=function(){var t=this;["min","max"].map(function(e){t.env[e]=Math[e].apply(null,t.env.t_data.data.map(function(t){return Math[e].apply(null,t)}))}),this.color=d3.scale.linear().domain([this.env.min,this.env.max]).range([this.env.args.c_low,this.env.args.c_high]),this.doms.colorbar.innerHTML="";var e=SVGAElement.prototype.create_node("svg",{style:"width:200px;height:40px"});this.doms.colorbar.appendChild(e);var n,r=.1*(this.env.max-this.env.min);Array.prototype.range(10).map(function(o){var i=t.env.min+r*o;e.appendChild(e.create_node("rect",{style:"stroke-width:0;fill:"+t.color(i),width:15,height:15,x:15*(o+1)})),[0,5].intersect([o]).length&&((n=e.create_node("text",{x:15*o,y:30})).innerHTML=i.toExponential(1),e.appendChild(n))}),(n=e.create_node("text",{x:150,y:30})).innerHTML=this.env.max.toExponential(1),e.appendChild(n)},a.prototype.matrix_cluster=function(){var t,e,n=this.env.t_data,r={};return["row","col"].map(function(i){e="row"==i?n.data:n.data.transpose(),t=o.agglomerate(n[i+"names"].range(),e,o.EUCLIDIAN_DISTANCE,o.COMPLETE_LINKAGE);var a=[];r[i+"_tree"]=function t(e,n,r){return-1!=e.label?(r.push(e.label),{name:n[e.label]}):{children:[t(e.left,n,r),t(e.right,n,r)]}}(t,n[i+"names"],a),r[i+"_ind"]=a}),r},a.prototype.dendrogram=function(t){var e,n,r,o,i=this.doms[t+"Dend"],a=d3.select(i),s=this.env.mat_clus[t+"_tree"],c=this.env.mat_clus[t+"_ind"],l=this.zbehav[t+"_d"],u=i.getBoundingClientRect(),p=d3.scale.linear(),h=d3.scale.linear();"col"==t?(r=e=u.width,n=250,p.range([1,0]),o="rotate(-90,"+n/2+","+n/2+") translate(240, 0)"):(e=250,r=n=u.height,o="translate(10, 0)"),h.domain([0,n]).range([0,n]),l["col"==t?"x":"y"](h);var f=d3.layout.cluster().separation(function(t,e){return 1}).size([r,90]),d=f.nodes(s),m=f.links(d);function y(){if(d3.event){var r=d3.event.translate,o=d3.event.scale;"col"==t?r[0]=Math.max(-e*(o-1),Math.min(0,r[0])):r[1]=Math.max(-n*(o-1),Math.min(0,r[1])),l.translate(r)}function i(t,e){return p(t.source.y)+","+h(t.source.x)+" "+p(t.source.y)+","+h(t.target.x)+" "+p(t.target.y)+","+h(t.target.x)}a.selectAll(".link").data(m).attr("points",i).enter().append("polyline").attr("class","link").attr("points",i);var s=a.selectAll(".node").data(d).attr("transform",function(t){return"translate("+p(t.y)+","+h(t.x)+")"}).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+p(t.y)+","+h(t.x)+")"}),u="col"==t?"end":"start",f="col"==t?-3:3;return s.filter(function(t,e){return!t.children}).property("ind",function(t,e){return c[e]}).append("text").attr("dx",f).attr("dy",3).style("text-anchor",u).text(function(t){return t.name})}return i.empty(),a=a.attr("width",e).attr("height",n).append("g").attr("transform",o),{draw:y,leaves:y()[0]}},a.prototype.colormap=function(){var t=this,e=d3.select(this.doms.colormap),n=this.doms.colormap.getBoundingClientRect(),r=n.width,o=n.height,i=this.env.t_data,a=i.colnames.length,s=i.rownames.length,c=this.env.mat_clus,l=c.row_ind.reduce(function(t,e){return t.concat(c.col_ind.reduce(function(t,n){return t.concat(i.data[e][n])},[]))},[]),u=d3.scale.linear().domain([0,a]).range([0,r]),p=d3.scale.linear().domain([0,s]).range([0,o]);this.zbehav.cmap_x.x(u),this.zbehav.cmap_y.y(p);var h=(e=e.attr("width",r).attr("height",o).append("g")).selectAll("rect").data(l);function f(){var n=[t.zbehav.cmap_x.translate()[0],t.zbehav.cmap_y.translate()[1]],r=[t.zbehav.cmap_x.scale(),t.zbehav.cmap_y.scale()];e.attr("transform","translate("+n[0]+" "+n[1]+") scale("+r[0]+" "+r[1]+")")}return h.enter().append("rect").classed("datapt",!0),h.exit().remove(),h.property("colIndex",function(t,e){return e%a}).property("rowIndex",function(t,e){return Math.floor(e/a)}).attr("x",function(t,e){return u(e%a)}).attr("y",function(t,e){return p(Math.floor(e/a))}).attr("width",u(1)).attr("height",p(1)).attr("fill",function(e){return t.color(e)}),f(),{draw:f}},a.prototype.cmap_zoom=function(){var t=this;function e(){t.zbehav.cmap_x.scale(t.zbehav.col_d.scale()),t.zbehav.cmap_y.scale(t.zbehav.row_d.scale()),t.zbehav.cmap_x.translate(t.zbehav.col_d.translate()),t.zbehav.cmap_y.translate(t.zbehav.row_d.translate()),t.env.cmap.draw()}this.zbehav.col_d.on("zoom",function(){t.env.col_dend.draw(),e()}),this.zbehav.row_d.on("zoom",function(){t.env.row_dend.draw(),e()})},a.prototype.sel_data_ck=function(){var t=this.doms.rowDend.querySelectorAll(".select");this.env.sel_row=Array.prototype.slice.apply(t).map(function(t){return t.parentNode.ind}),this.env.sel_row.length?this.doms.f_control.b_save.value="save selected data["+this.env.sel_row.length+"]":this.doms.f_control.b_save.value="save data table"},a.prototype.data_save=function(t){var e=this.env.data,n=[],r=[];this.env.sel_row.length?this.env.sel_row.map(function(t){n.push(e.data[t]),r.push(e.rownames[t])}):(n=e.data,r=e.rownames),i(new Blob([[r].concat(n.transpose()).transpose().to_table([""].concat(e.colnames))],{type:"text/plain;charset=utf-8"}),"data.csv")},a.prototype.sel_locale=function(){var t,e=this.env.mat_clus.row_ind,n=this.doms.rowDend.querySelectorAll("g.node>text");this.env.sel_row.map(function(r){-1!=(t=e.indexOf(r))&&n[t].classList.add("select")})},a.prototype.tip_html=function(t,e,n){return[["rowname",n.rownames[t]],["colname",n.colnames[e]],["data",n.data[t][e]]].map(function(t){return t.join(":")}).join("<br/>")}},function(t,e){t.i="Array.js",Array.prototype.unique=function(){for(var t=[],e=this.length,n=0;n<e;n++){for(var r=n+1;r<e;r++)this[n]===this[r]&&(r=++n);t.push(this[n])}return t},Array.prototype.intersect=function(){if(!arguments.length)return[];for(var t,e=this,n=[],r=0;r<arguments.length;){n=[],t=arguments[r];for(var o=e.length,i=t.length,a=0;a<o;a++)for(var s=0;s<i;s++)e[a]===t[s]&&n.push(e[a]);e=n,r++}return n.unique()},Array.prototype.diff=function(){for(var t,e=this,n=[],r=0;r<arguments.length;){n=[],t=arguments[r];for(var o=e.length,i=t.length,a=!0,s=0;s<o;s++){for(var c=0;c<i;c++)if(e[s]===t[c]){a=!1;break}a?n.push(e[s]):a=!0}e=n,r++}return n.unique()},Array.prototype.range=function(t){var e=t||this.length;return Array.apply(null,Array(e)).map(function(t,e){return e})},Array.prototype.limit=function(){return[Math.min.apply(null,this),Math.max.apply(null,this)]},Array.prototype.ncombine=function(t,e){if(e=e||[],0==t)return[e];var n=this;return n.reduce(function(r,o,i){return r.concat(n.slice(i+1).ncombine(t-1,e.concat(o)))},[])},Array.prototype.range_ind=function(t){var e;for(e=0;e<this.length&&!(t<this[e]);e++);return e-1},Array.prototype.transpose=function(){var t=this,e=t.map(function(t){return t.length}).sort();return e[0]<e[e.length-1]&&console.log("arrays dimesion are not equal when transpose"),t[0].slice(0,e[0]).map(function(e,n){return t.map(function(t){return t[n]})})},Array.prototype.toggle=function(t){var e=this.indexOf(t);return-1==e?this.push(t):this.splice(e,1),this},Array.prototype.scale_norm=function(t,e){var n=Math.min.apply(this,e||this),r=(Math.max.apply(this,e||this)-n)/t;return this.reduce(function(t,e){return t.concat(Math.round((e-n)/r))},[])},Array.prototype.to_matrix=function(){var t=this.slice(1).transpose();return{colnames:this[0].slice(1),rownames:t[0],data:t.slice(1).map(function(t){return t.map(function(t){return Number(t)})}).transpose()}},Array.prototype.count=function(t){for(var e=this.indexOf(t),n=0;-1!=e;)n++,e=this.indexOf(t,e+1);return n}},function(t,e){t.i="String.js",String.prototype.b64tobin=function(){for(var t=atob(this),e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n},String.prototype.list2array=function(){for(var t=this.match(/[^\r\n]+/g),e=[],n=0;n<t.length;n++){var r=t[n].trim();r&&e.push(r)}return e},String.prototype.to_tab_array=function(){return this.list2array().map(function(t){return t.split("\t")})},String.prototype.fasta=function(t,e){for(var n=[">"+t],r=0;r<this.length;r+=70)n.push(this.slice(r,r+70));return n.join(e||"\n")},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.query2dict=function(){var t=this.substr(1).split("&");if(""==t)return{};for(var e={},n=0;n<t.length;n++){var r=t[n].split("=");2==r.length&&(e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," ")))}return e},dict2query=function(t){return"?"+Object.keys(t).reduce(function(e,n){return e.concat([n+"="+encodeURIComponent(t[n])])},[]).join("&")}},function(t,e){Array.prototype.sum=function(){return this.reduce(function(t,e){return t+e})},Array.prototype.mean=function(){return this.sum()/this.length},Array.prototype.ss=function(){var t=this.mean();return this.map(function(e){return Math.pow(e-t,2)}).sum()},Array.prototype.sd=function(){return Math.pow(this.ss()/this.length,.5)},Array.prototype.cv=function(){return this.sd()/this.mean()},Array.prototype.z_scores=function(){var t=this.mean(),e=this.sd();return e?this.map(function(n){return(n-t)/e}):Array.apply(null,new Array(this.length)).map(function(){return 0})}},function(t,e){Array.prototype.to_table=function(t){return(t&&"#"+t.join("\t")+"\n"||"")+this.reduce(function(t,e){return t.concat(e.join("\t"))},[]).join("\n")},Array.prototype.html_table=function(t){return"<table>"+(t?"<thead><tr><th>"+t.join("</th><th>")+"</th></tr></thead>":"")+"<tbody>"+this.reduce(function(t,e){return t.concat("<tr><td>"+e.join("</td><td>")+"</td></tr>")},[]).join("")+"</tbody></table>"}},function(t,e){t.i="SVGElement.js",SVGElement.prototype.svg_string=function(){return(new XMLSerializer).serializeToString(this)},SVGElement.prototype.svg_base64=function(){return"data:image/svg+xml;base64,"+btoa(this.svg_string())},SVGElement.prototype.png_base64=function(t){var e=this.style.width.split("px")[0],n=this.style.height.split("px")[0],r=document.createElement("canvas"),o=new Image,i=document.getElementsByTagName("body")[0],a=r.getContext("2d");return o.style.width=e,o.style.height=n,r.width=e,r.height=n,i.appendChild(o),i.appendChild(r),o.onload=function(e){if(e.currentTarget.parentNode){var n=e.currentTarget;a.fillStyle="#fff",a.fillRect(0,0,400,400),a.drawImage(n,0,0),n.src=r.toDataURL("image/png"),t&&t(n.src),i.removeChild(o),i.removeChild(r)}},o.src=this.svg_base64(),o},SVGElement.prototype.create_node=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&Object.keys(e).map(function(t){n.set_attr(t,e[t])}),n},SVGElement.prototype.set_attr=function(t,e){var n=t.split(":"),r=2==n.length?n[0]:null,o=2==n.length?n[1]:n[0];return"xlink"==r&&(r="http://www.w3.org/1999/xlink"),this.setAttributeNS(r,o,e),this},SVGElement.prototype.empty=function(){for(;this.lastChild;)this.removeChild(this.lastChild);return this}},function(t,e,n){t.i="HTMLFormElement.js";var r=n(1);n(14),n(15),n(16),HTMLFormElement.prototype.validate_handler=function(t){var e;return(e=this.validators[t.target.name])&&(t.target.setCustomValidity(""),""==t.target.validationMessage&&t.target.setCustomValidity(e(t))),t.target.form.checkValidity()},HTMLFormElement.prototype.validators={},HTMLFormElement.prototype.val=function(t){var e,n=this;return Array.prototype.slice.call(this).reduce(function(t,e){var n=e.getAttribute("name");return-1==t.indexOf(n)&&n&&t.push(n),t},[]).reduce(function(r,o){return e=t&&t[o]||null,r[o]=n.elem_val(o,e),r},{})},HTMLFormElement.prototype.elem_val=function(t,e){if(!this[t])return null;var n=this;return 0==["[type=checkbox]","select[multiple]","[type=radio]"].reduce(function(e,r){return e+(n[t].DOCUMENT_NODE?n[t]:n[t][0]).matches(r)},0)?(e&&(n[t].value=e),n[t].value):n[t].length?n[t].ind_val("checked",e):(e&&(n[t].checked=-1!=e.indexOf(n[t].value)),n[t].checked?[n[t].value]:[])},HTMLFormElement.prototype.safari_validity=function(t,e){var n,o=this;if(!this.tip_obj){var i=document.createElement("span");this.appendChild(i),this.tip_obj=new r(i)}for(n=0;n<this.length;n++)if(""!=this[n].validationMessage)return this.tip_obj.show_dom(this[n],[this[n].validationMessage]),setTimeout(function(){o.tip_obj.hide()},3e3),!1;return!0}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,l=[],u=!1,p=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):p=-1,l.length&&f())}function f(){if(!u){var t=s(h);u=!0;for(var e=l.length;e;){for(c=l,l=[];++p<e;)c&&c[p].run();p=-1,e=l.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||u||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){t.i="NodeList.js",NodeList.prototype.ind_val=function(t,e){var n=Array.prototype.slice.call(this);return e?(n.map(function(n){n[t]=-1!=e.indexOf(n.value)}),e):n.reduce(function(e,n){return n[t]&&e.push(n.value),e},[])},NodeList.prototype.attr_map=function(t,e,n){var r,o;return Array.prototype.slice.call(this).map(function(i){(r=!t||i.getAttribute(t))&&("function"==typeof e?o=e(r):"object"==typeof e?o=e[r]:"string"==typeof e&&(o=e),o&&i.setAttribute(n,o))}),this}},function(t,e){t.i="HTMLCollection.js",HTMLCollection.prototype.ind_val=function(t,e){var n=Array.prototype.slice.call(this);return e?(n.map(function(n){n[t]=-1!=e.indexOf(n.value)}),e):n.reduce(function(e,n){return n[t]&&e.push(n.value),e},[])},HTMLCollection.prototype.attr_map=function(t,e,n){var r,o;return Array.prototype.slice.call(this).map(function(i){(r=i.getAttribute(t))&&(o="function"==typeof e?e(r):e[r])&&i.setAttribute(n,o)}),this}},function(t,e){t.i="HTMLSelectElement.js",HTMLSelectElement.prototype.ind_val=function(t){return t?(Array.prototype.slice.call(this.options).map(function(e){e.selected=-1!=t.indexOf(e.value)}),this):Array.prototype.slice.call(this.selectedOptions).map(function(t){return t.value})}},function(t,e){
/*!
 * Figue from https://github.com/nantunes/figue/blob/master/figue.js
 * compact into nodejs module
 * only keep cluster function, not generateDendogram
 */
t.i="fique";var n=function(){};t.exports=n,n.SINGLE_LINKAGE=0,n.COMPLETE_LINKAGE=1,n.AVERAGE_LINKAGE=2,n.EUCLIDIAN_DISTANCE=0,n.MANHATTAN_DISTANCE=1,n.MAX_DISTANCE=2,n.PRINT_VECTOR_VALUE_PRECISION=2,n.KMEANS_MAX_ITERATIONS=10,n.FCMEANS_MAX_ITERATIONS=3,n.euclidianDistance=function(t,e){for(var n=t.length,r=0,o=0;o<n;o++)r+=Math.pow(t[o]-e[o],2);return r=Math.sqrt(r)},n.manhattanDistance=function(t,e){for(var n=t.length,r=0,o=0;o<n;o++)r+=Math.abs(t[o]-e[o]);return r},n.maxDistance=function(t,e){for(var n=t.length,r=0,o=0;o<n;o++)r=Math.max(r,Math.abs(t[o]-e[o]));return r},n.addVectors=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++)r[o]=t[o]+e[o];return r},n.multiplyVectorByValue=function(t,e){for(var n=vec.length,r=new Array(n),o=0;o<n;o++)r[o]=t*vec[o];return r},n.vectorDotProduct=function(t,e){for(var n=t.length,r=0,o=0;o<n;o++)r+=t[o]*e[o];return r},n.calculateCentroid=function(t,e,n,r){for(var o=new Array(e.length),i=t+n,a=0;a<e.length;a++)o[a]=(t*e[a]+n*r[a])/i;return o},n.agglomerate=function(t,e,n,r){var o,i,a,s,c,l,u,p,h,f=e.length,d=new Array(f),m=new Array(f),y=new this.Matrix(f,f).mtx,v=new Array(f);for(n==this.EUCLIDIAN_DISTANCE?n=this.euclidianDistance:n==this.MANHATTAN_DISTANCE?n=this.manhattanDistance:n==this.MAX_DISTANCE&&(n=this.maxDistance),c=0;c<f;c++)for(d[c]=0,l=0;l<f;l++)y[c][l]=c==l?1/0:n(e[c],e[l]),y[c][d[c]]>y[c][l]&&(d[c]=l);for(c=0;c<f;c++)v[c]=[],v[c][0]=new this.Node(t[c],null,null,0,e[c]),m[c]=1;for(u=0;u<f-1;u++){for(o=0,c=0;c<f;c++)y[c][d[c]]<y[o][d[o]]&&(o=c);for(i=d[o],a=v[o][0],s=v[i][0],h=this.calculateCentroid(a.size,a.centroid,s.size,s.centroid),newCluster=new this.Node(-1,a,s,y[o][i],h),v[o].splice(0,0,newCluster),m[o]+=m[i],l=0;l<f;l++)if(r==this.SINGLE_LINKAGE)y[o][l]>y[i][l]&&(y[l][o]=y[o][l]=y[i][l]);else if(r==this.COMPLETE_LINKAGE)y[o][l]<y[i][l]&&(y[l][o]=y[o][l]=y[i][l]);else if(r==this.AVERAGE_LINKAGE){var g=(m[o]*y[o][l]+m[i]*y[i][l])/(m[o]+m[l]);y[l][o]=y[o][l]=g}for(y[o][o]=1/0,c=0;c<f;c++)y[c][i]=y[i][c]=1/0;for(l=0;l<f;l++)d[l]==i&&(d[l]=o),y[o][l]<y[o][d[o]]&&(d[o]=l);p=newCluster}return p},n.getRandomVectors=function(t,e){var n=e.length;if(t>n)return null;for(var r,o,i,a=new Array(t),s=new Array(t),c=new Object,l=0,u=0;u<t;){if(l==n)return null;var p=Math.floor(Math.random()*n);if(!(p in c)){for(c[p]=1,l++,o=e[p],i=!0,r=0;r<u;r++)if(o.compare(a[r])){i=!1;break}i&&(a[u]=o,s[u]=p,u++)}}return{vectors:a,indices:s}},n.kmeans=function(t,e){var n=e.length,r=new Array(n),o=new Array(t),i=!0,a=0,s=null,c=this.getRandomVectors(t,e);if(null==c)return null;for(s=c.vectors;i;){for(var l=0;l<t;l++)o[l]=0;for(var u=0;u<n;u++){var p,h=e[u],f=Number.MAX_VALUE;for(l=0;l<t;l++)dist=this.euclidianDistance(s[l],h),dist<f&&(f=dist,p=l);o[p]++,r[u]=p}var d=new Array(t);for(l=0;l<t;l++)d[l]=null;for(u=0;u<n;u++)cluster=r[u],null==d[cluster]?d[cluster]=e[u]:d[cluster]=this.addVectors(d[cluster],e[u]);for(l=0;l<t;l++)d[l]=this.multiplyVectorByValue(1/o[l],d[l]);i=!1;for(l=0;l<t;l++)if(!d[l].compare(s[l])){i=!0;break}s=d,++a>this.KMEANS_MAX_ITERATIONS&&(i=!1)}return{centroids:s,assignments:r}},n.fcmeans=function(t,e,n,r){for(var o,i,a,s,c,l,u,p=new this.Matrix(e.length,t),h=!0,f=0,d=null;h;){if(null==d){if(null==(s=this.getRandomVectors(t,e)))return null;d=s.vectors}else for(i=0;i<t;i++){for(d[i]=[],c=0,o=0;o<p.rows;o++)c+=Math.pow(p.mtx[o][i],r),s=this.multiplyVectorByValue(Math.pow(p.mtx[o][i],r),e[o]),d[i]=0==o?s:this.addVectors(d[i],s);c>0&&(d[i]=this.multiplyVectorByValue(1/c,d[i]))}for(previousMembershipMatrix=p.copy(),o=0;o<p.rows;o++)for(i=0;i<t;i++){for(p.mtx[o][i]=0,a=0;a<t;a++)s=0==this.euclidianDistance(e[o],d[a])?0:this.euclidianDistance(e[o],d[i])/this.euclidianDistance(e[o],d[a]),s=Math.pow(s,2/(r-1)),p.mtx[o][i]+=s;p.mtx[o][i]>0&&(p.mtx[o][i]=1/p.mtx[o][i])}for(l=-1,o=0;o<p.rows;o++)for(i=0;i<p.cols;i++)(u=Math.abs(p.mtx[o][i]-previousMembershipMatrix.mtx[o][i]))>l&&(l=u);l<n&&(h=!1),++f>this.FCMEANS_MAX_ITERATIONS&&(h=!1)}return{centroids:d,membershipMatrix:p}},n.Matrix=function(t,e){this.rows=t,this.cols=e,this.mtx=new Array(t);for(var n=0;n<t;n++){for(var r=new Array(e),o=0;o<e;o++)r[o]=0;this.mtx[n]=r}},n.Node=function(t,e,n,r,o){this.label=t,this.left=e,this.right=n,this.dist=r,this.centroid=o,null==e&&null==n?(this.size=1,this.depth=0):(this.size=e.size+n.size,this.depth=1+Math.max(e.depth,n.depth))},n.Matrix.prototype.toString=function(){for(var t=[],e=0;e<this.rows;e++)t.push(this.mtx[e].join("\t"));return t.join("\n")},n.Matrix.prototype.copy=function(){for(var t=new n.Matrix(this.rows,this.cols),e=0;e<this.rows;e++)t.mtx[e]=this.mtx[e].slice(0);return t},n.Node.prototype.isLeaf=function(){return null==this.left&&null==this.right},Array.prototype.compare=function(t){if(this.length!=t.length)return!1;for(var e=0;e<t.length;e++){if(this[e].compare&&!this[e].compare(t[e]))return!1;if(this[e]!==t[e])return!1}return!0}},function(t,e,n){var r,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=function(){return t.URL||t.webkitURL||t},n=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,o=/constructor/i.test(t.HTMLElement),i=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},s=function(t){setTimeout(function(){"string"==typeof t?e().revokeObjectURL(t):t.remove()},4e4)},c=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},l=function(l,u,p){p||(l=c(l));var h,f=this,d="application/octet-stream"===l.type,m=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var o=t["on"+e[r]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){a(t)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,r)return h=e().createObjectURL(l),void setTimeout(function(){n.href=h,n.download=u,function(t){var e=new MouseEvent("click");t.dispatchEvent(e)}(n),m(),s(h),f.readyState=f.DONE});!function(){if((i||d&&o)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,f.readyState=f.DONE,m()},n.readAsDataURL(l),void(f.readyState=f.INIT)}h||(h=e().createObjectURL(l)),d?t.location.href=h:t.open(h,"_blank")||(t.location.href=h);f.readyState=f.DONE,m(),s(h)}()},u=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=c(t)),navigator.msSaveOrOpenBlob(t,e)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,e,n){return new l(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */void 0!==t&&t.exports?t.exports.saveAs=o:null!==n(19)&&null!==n(20)&&(void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r))},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){n(22),t.i="events_reg";var r=function(t){this.body=t,this.events={},this.attached=[]};t.exports=r,r.prototype.events_han=function(t){var e,n=this.events[t.type];if(n)if("function"==typeof n)n(t);else for(e in n)t.target.matches(e)&&n[e](t)},r.prototype.register=function(){var t,e=this;for(t in this.events)-1==this.attached.indexOf(t)&&(this.body.addEventListener(t,function(t){e.events_han(t)}),this.attached.push(t))},r.prototype.trigger_event=function(t,e){var n=document.createEvent("HTMLEvents");return n.initEvent(e,!1,!0),t.dispatchEvent(n),n}},function(t,e){t.i="Element.js",Element.prototype.matches=Element.prototype.matches||Element.prototype.msMatchesSelector},function(t,e){},,,,,function(t,e){}]);